<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>รายงานการเงิน {{ month_label }}</title>
  <style>
    body{
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      font-size:12px;
      color:#111827;
      margin:24px;
    }
    h1,h2,h3{
      margin:0 0 4px;
    }
    .muted{
      color:#6b7280;
      font-size:11px;
    }
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:8px;
    }
    th,td{
      padding:4px 6px;
      border:1px solid #e5e7eb;
    }
    th{
      background:#f3f4f6;
      font-weight:600;
    }
    .text-right{text-align:right;}
    .text-center{text-align:center;}
    .section{
      margin-bottom:16px;
    }
    .badge{
      display:inline-block;
      padding:1px 6px;
      border-radius:999px;
      font-size:10px;
      border:1px solid #d1d5db;
      color:#4b5563;
    }
  </style>
</head>
<body>
  <h1>รายงานการเงินประจำเดือน {{ month_label }}</h1>
  <div class="muted">
    สรุปรายรับ-รายจ่าย และการใช้จ่ายตามหมวดหมู่ (เฉพาะรายการจริง)
  </div>

  <div class="section">
    <h2>ภาพรวมเดือนนี้</h2>
    <table>
      <tr>
        <th>รายการ</th>
        <th class="text-right">จำนวนเงิน (บาท)</th>
      </tr>
      <tr>
        <td>รายรับรวม</td>
        <td class="text-right">{{ income_month|floatformat:2 }}</td>
      </tr>
      <tr>
        <td>รายจ่ายรวม</td>
        <td class="text-right">{{ expense_month|floatformat:2 }}</td>
      </tr>
      <tr>
        <td>สุทธิ (รายรับ - รายจ่าย)</td>
        <td class="text-right">{{ net_month|floatformat:2 }}</td>
      </tr>
    </table>
  </div>

  <div class="section">
    <h2>สรุปรายจ่ายตามหมวดหมู่</h2>
    <table>
      <thead>
        <tr>
          <th>หมวด</th>
          <th class="text-right">งบต่อเดือน</th>
          <th class="text-right">ใช้จริง</th>
          <th class="text-right">คงเหลือ</th>
        </tr>
      </thead>
      <tbody>
        {% for row in rows %}
          <tr>
            <td>{{ row.category.name }}</td>
            <td class="text-right">
              {% if row.budget > 0 %}
                {{ row.budget|floatformat:2 }}
              {% else %}
                -
              {% endif %}
            </td>
            <td class="text-right">{{ row.used|floatformat:2 }}</td>
            <td class="text-right">
              {% if row.budget > 0 %}
                {{ row.remaining|floatformat:2 }}
              {% else %}
                -
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="section">
    <h2>สรุปงบโดยรวม</h2>
    <table>
      <tr>
        <th>รวมงบทุกหมวด</th>
        <th class="text-right">รวมใช้จริง</th>
        <th class="text-right">งบคงเหลือ</th>
      </tr>
      <tr>
        <td class="text-right">{{ total_budget|floatformat:2 }}</td>
        <td class="text-right">{{ total_used|floatformat:2 }}</td>
        <td class="text-right">{{ net_remaining|floatformat:2 }}</td>
      </tr>
    </table>
  </div>
</body>
</html>
