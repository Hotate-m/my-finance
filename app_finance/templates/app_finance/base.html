<!DOCTYPE html>
<html lang="th" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}My Finance{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap 5 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Google Fonts: Prompt (TH/EN) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* ===== ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô ===== */
    :root{
      --radius-xl:22px;
      --radius-lg:18px;
      --radius-pill:999px;
      --shadow-strong:0 24px 70px rgba(15,23,42,.95);
    }

    /* ===== ‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î (‡∏ò‡∏µ‡∏°‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡πÇ‡∏≠‡πá‡∏ï) ===== */
    html[data-theme="dark"]{
      --brand:#16a34a;         /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏°‡∏∑‡∏î‡∏•‡∏á */
      --brand-dark:#15803d;
      --brand-soft:#bbf7d0;

      --text-main:#e5e7eb;
      --text-muted:#9ca3af;

      --bg:#020617;
      --bg-elevated:#020617;
      --border-subtle:rgba(148,163,184,.3);

      --shadow-strong:0 24px 70px rgba(15,23,42,.95);
    }

    /* ===== ‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏ß‡πà‡∏≤‡∏á (‡∏û‡∏∑‡πâ‡∏ô‡∏Ç‡∏≤‡∏ß) ===== */
    html[data-theme="light"]{
      --brand:#16a34a;
      --brand-dark:#15803d;
      --brand-soft:#dcfce7;

      --text-main:#0f172a;
      --text-muted:#6b7280;

      --bg:#f3f4f6;
      --bg-elevated:#ffffff;
      --border-subtle:#e5e7eb;

      --shadow-strong:0 18px 40px rgba(15,23,42,.08);
    }

    *{
      box-sizing:border-box;
    }

    body{
      margin:0;
      min-height:100vh;
      font-family: "Prompt", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color:var(--text-main);
      background:var(--bg);
    }

    /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏ö‡∏ö gradient ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î */
    html[data-theme="dark"] body{
      background:
        radial-gradient(circle at top, rgba(74,222,128,.18), transparent 60%),
        radial-gradient(circle at bottom, rgba(37,99,235,.18), transparent 55%),
        #020617;
    }

    html[data-theme="light"] body{
      background:var(--bg);
    }

    /* ===== Nav dropdown ===== */
    .nav-links{
      display:flex;
      align-items:center;
      gap:16px;
      font-size:14px;
    }
    .nav-dropdown{
      position:relative;
    }
    .nav-dropdown-toggle{
      border:none;
      background:transparent;
      color:inherit;
      font:inherit;
      padding:4px 0;
      display:flex;
      align-items:center;
      gap:4px;
      cursor:pointer;
    }
    .nav-dropdown-toggle:focus{
      outline:none;
    }
    .nav-caret{
      font-size:10px;
      opacity:.7;
    }
    .nav-dropdown-menu{
      position:absolute;
      top:100%;
      left:0;
      min-width:180px;
      background:rgba(15,23,42,.98);
      border-radius:12px;
      padding:6px 0;
      box-shadow:0 18px 45px rgba(15,23,42,.7);
      border:1px solid rgba(148,163,184,.35);
      opacity:0;
      pointer-events:none;
      transform:translateY(6px);
      transition:opacity .16s ease, transform .16s ease;
      z-index:50;
    }
    .nav-dropdown:hover .nav-dropdown-menu{
      opacity:1;
      pointer-events:auto;
      transform:translateY(0);
    }
    .nav-dropdown-menu a{
      display:block;
      padding:6px 12px;
      font-size:13px;
      color:#e5e7eb;
      text-decoration:none;
      white-space:nowrap;
    }
    .nav-dropdown-menu a:hover{
      background:rgba(34,197,94,.12);
      color:#bbf7d0;
    }

    /* dropdown ‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏ß‡πà‡∏≤‡∏á */
    html[data-theme="light"] .nav-dropdown-menu{
      background:#ffffff;
      border-color:#e5e7eb;
      box-shadow:0 18px 45px rgba(15,23,42,.18);
    }
    html[data-theme="light"] .nav-dropdown-menu a{
      color:#111827;
    }
    html[data-theme="light"] .nav-dropdown-menu a:hover{
      background:#f3f4f6;
      color:#065f46;
    }

    .app-shell{
      min-height:100vh;
      display:flex;
      flex-direction:column;
    }

    .app-nav{
      position:sticky;
      top:0;
      z-index:20;
      backdrop-filter: blur(22px);
      background:var(--bg-elevated);
      border-bottom:1px solid var(--border-subtle);
    }

    /* ‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î‡πÉ‡∏ä‡πâ gradient ‡πÄ‡∏î‡∏¥‡∏° */
    html[data-theme="dark"] .app-nav{
      background: linear-gradient(
        to right,
        rgba(15,23,42,.96),
        rgba(15,23,42,.9),
        rgba(15,23,42,.96)
      );
    }

    .app-container{
      width:min(1120px, 100% - 24px);
      margin:0 auto;
    }

    .brand-mark{
      width:32px;
      height:32px;
      border-radius:var(--radius-pill);
      background: radial-gradient(circle at 30% 20%, #bbf7d0, #4ade80);
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:0 0 0 1px rgba(34,197,94,.7), 0 0 24px rgba(34,197,94,.6);
    }
    .brand-mark span{
      font-size:17px;
      color:#052e16;
      font-weight:900;
    }

    .brand-text{
      font-weight:800;
      letter-spacing:.04em;
      font-size:16px;
    }
    .brand-sub{
      font-size:11px;
      color:var(--text-muted);
    }

    .nav-links a{
      font-size:13px;
      border-radius:999px;
      padding:6px 12px;
      color:var(--text-muted);
      text-decoration:none;
      border:1px solid transparent;
    }
    .nav-links a:hover{
      color:var(--text-main);
      border-color:rgba(148,163,184,.6);
      background:rgba(15,23,42,.7);
    }
    html[data-theme="light"] .nav-links a:hover{
      background:rgba(243,244,246,1);
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏´‡∏•‡∏±‡∏Å ‚Äì ‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ü‡∏∏‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏•‡∏á‡∏≠‡∏µ‡∏Å */
    .btn-brand{
      background:var(--brand);
      border:1px solid var(--brand-dark);
      color:#f9fafb;
      font-weight:600;
      border-radius:var(--radius-pill);
      padding-inline:16px;
      box-shadow:0 3px 8px rgba(22,163,74,.25);
      font-size:13px;
      transition:background .16s ease, box-shadow .16s ease;
    }
    .btn-brand:hover{
      background:var(--brand-dark);
      color:#f9fafb;
      box-shadow:0 4px 10px rgba(22,163,74,.30);
    }
    .btn-brand:active{
      box-shadow:0 2px 6px rgba(22,163,74,.25);
    }

    .btn-ghost{
      border-radius:var(--radius-pill);
      border:1px solid var(--border-subtle);
      color:var(--text-main);
      font-size:13px;
      padding-inline:14px;
      background:rgba(15,23,42,.7);
      box-shadow:none;
    }
    .btn-ghost:hover{
      background:rgba(15,23,42,1);
      border-color:rgba(209,213,219,1);
      color:#f9fafb;
    }
    html[data-theme="light"] .btn-ghost{
      background:#ffffff;
      color:var(--text-muted);
    }
    html[data-theme="light"] .btn-ghost:hover{
      background:#f3f4f6;
      color:var(--text-main);
      border-color:#d1d5db;
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö = ‡πÅ‡∏î‡∏á */
    .btn-logout{
      border-radius:var(--radius-pill);
      font-size:13px;
      padding-inline:14px;
      border:1px solid #ef4444;
      background:#b91c1c;
      color:#fee2e2;
      box-shadow:0 3px 8px rgba(185,28,28,.4);
    }
    .btn-logout:hover{
      background:#dc2626;
      border-color:#f97373;
      color:#fef2f2;
      box-shadow:0 4px 10px rgba(239,68,68,.55);
    }
    html[data-theme="light"] .btn-logout{
      background:#ef4444;
      color:#ffffff;
      border-color:#b91c1c;
      box-shadow:0 3px 8px rgba(248,113,113,.35);
    }
    html[data-theme="light"] .btn-logout:hover{
      background:#dc2626;
      color:#ffffff;
      border-color:#991b1b;
      box-shadow:0 4px 10px rgba(248,113,113,.5);
    }

    /* ===== ‡∏ü‡∏≠‡∏£‡πå‡∏°: ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤ (‡∏£‡∏ß‡∏°‡∏´‡∏ô‡πâ‡∏≤ login) ===== */
    html[data-theme="dark"] .form-control{
      background:#020617;
      color:#e5e7eb;
      border-radius:999px;
      border:1px solid rgba(31,41,55,.9);
      box-shadow:0 0 0 1px rgba(15,23,42,1);
      font-size:13px;
    }
    html[data-theme="dark"] .form-control::placeholder{
      color:#6b7280;
    }

    html[data-theme="light"] .form-control{
      background:#f9fafb;
      color:#0f172a;
      border-radius:999px;
      border:1px solid #e5e7eb;
      box-shadow:0 0 0 1px #e5e7eb;
      font-size:13px;
    }
    html[data-theme="light"] .form-control::placeholder{
      color:#9ca3af;
    }

    .form-control:focus{
      outline:none;
      box-shadow:0 0 0 1px #22c55e;
      border-color:#22c55e;
    }

    .app-main{
      flex:1;
      padding:18px 0 30px;
    }

    .card-soft{
      border-radius:var(--radius-lg);
      border:1px solid var(--border-subtle);
      box-shadow:var(--shadow-strong);
      background:var(--bg-elevated);
    }
    /* ‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î‡πÉ‡∏ä‡πâ gradient ‡πÄ‡∏î‡∏¥‡∏° */
    html[data-theme="dark"] .card-soft{
      background:radial-gradient(circle at top left, rgba(56,189,248,.08), transparent 55%),
                 radial-gradient(circle at bottom right, rgba(74,222,128,.06), transparent 55%),
                 rgba(15,23,42,.96);
    }

    .card-soft-ghost{
      border-radius:var(--radius-lg);
      border:1px solid var(--border-subtle);
      background:var(--bg-elevated);
    }
    html[data-theme="dark"] .card-soft-ghost{
      background:rgba(15,23,42,.85);
      border:1px solid rgba(51,65,85,.9);
    }

    .badge-chip{
      border-radius:999px;
      padding:4px 10px;
      font-size:11px;
      border:1px solid var(--border-subtle);
      background:var(--bg-elevated);
      color:var(--text-muted);
    }

    .pill-label{
      font-size:11px;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid var(--border-subtle);
      color:var(--text-muted);
    }

    h1,h2,h3,h4,h5,h6{
      margin:0;
      color:#f9fafb;
      letter-spacing:.01em;
      font-weight:600;
    }
    html[data-theme="light"] h1,
    html[data-theme="light"] h2,
    html[data-theme="light"] h3,
    html[data-theme="light"] h4,
    html[data-theme="light"] h5,
    html[data-theme="light"] h6{
      color:#0f172a;
    }

    a{
      text-decoration:none;
    }

    footer{
      font-size:11px;
      color:var(--text-muted);
      padding-bottom:56px; /* ‡∏Å‡∏±‡∏ô‡∏ä‡∏ô quickbar ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    }

    .table-dark{
      --bs-table-bg: transparent;
      --bs-table-border-color: rgba(30,41,59,.8);
    }
    .table-dark tbody tr:hover{
      background:rgba(15,23,42,.9);
    }
    html[data-theme="light"] .table-dark{
      --bs-table-bg: #ffffff;
      --bs-table-border-color:#e5e7eb;
    }
    html[data-theme="light"] .table-dark tbody tr:hover{
      background:#f9fafb;
    }

    /* Quickbar ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    .mobile-quickbar{
      position:fixed;
      left:0;
      right:0;
      bottom:0;
      z-index:40;
    }
    .mobile-quickbar-inner{
      background:rgba(15,23,42,.98);
      border-top:1px solid rgba(148,163,184,.4);
      box-shadow:0 -10px 30px rgba(15,23,42,.9);
    }
    html[data-theme="light"] .mobile-quickbar-inner{
      background:#ffffff;
      border-top:1px solid #e5e7eb;
      box-shadow:0 -10px 25px rgba(15,23,42,.16);
    }
    .mobile-quickbar-btn{
      flex:1;
      border-radius:999px;
      font-size:12px;
      padding:7px 0;
    }

    /* Offcanvas mobile menu */
    .offcanvas-custom{
      background:var(--bg-elevated);
      color:var(--text-main);
      border-left:1px solid var(--border-subtle);
    }
    .offcanvas-custom .offcanvas-title{
      font-size:15px;
      font-weight:600;
    }
    .offcanvas-custom .btn-close{
      filter:invert(1);
    }
    html[data-theme="light"] .offcanvas-custom .btn-close{
      filter:none;
    }
    .mobile-nav-link{
      display:block;
      width:100%;
      text-align:left;
      padding:8px 10px;
      border-radius:12px;
      font-size:14px;
      color:var(--text-main);
      border:1px solid transparent;
      background:transparent;
    }
    .mobile-nav-link:hover{
      background:rgba(15,23,42,.8);
      border-color:var(--border-subtle);
      text-decoration:none;
    }
    html[data-theme="light"] .mobile-nav-link:hover{
      background:#f3f4f6;
    }
    .mobile-nav-section-title{
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.08em;
      color:var(--text-muted);
      margin-top:8px;
      margin-bottom:4px;
    }

    @media (max-width: 768px){
      .app-main{
        padding-top:12px;
        padding-bottom:80px; /* ‡πÄ‡∏ú‡∏∑‡πà‡∏≠ quickbar */
      }
      .brand-sub{
        display:none;
      }
    }

    #themeToggle{
      margin-right: 10px;  /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≠‡πÉ‡∏´‡∏ç‡πà */
    }

    /* ‡∏à‡∏≠‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‚Äì ‡∏Ç‡∏¢‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏´‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© */
    @media (max-width: 768px){
      #themeToggle{
        margin-right: 18px;  /* ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÉ‡∏Å‡∏•‡πâ‡πÑ‡∏õ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô 22 ‡∏Å‡πá‡πÑ‡∏î‡πâ */
      }
    }
  </style>

  {% block extra_head %}{% endblock %}
</head>
<body>
<div class="app-shell">
  {% block navbar %}
  <nav class="app-nav py-2">
    <div class="app-container d-flex align-items-center justify-content-between gap-3">
      <!-- ‡πÇ‡∏•‡πÇ‡∏Å‡πâ -->
      <a href="{% url 'app_finance:home' %}" class="d-flex align-items-center gap-2" style="color:inherit;">
        <div class="brand-mark">
          <span>‡∏ø</span>
        </div>
        <div class="d-flex flex-column">
          <span class="brand-text">OAT&nbsp;FINANCE</span>
          <span class="brand-sub">Personal money cockpit</span>
        </div>
      </a>

      <!-- ‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏î‡∏™‡∏Å‡πå‡∏ó‡πá‡∏≠‡∏õ -->
      <div class="d-flex align-items-center gap-2 d-none d-md-flex nav-links ms-auto">
        <!-- ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô -->
        <div class="nav-dropdown">
          <button class="nav-dropdown-toggle">
            ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
            <span class="nav-caret">‚ñæ</span>
          </button>
          <div class="nav-dropdown-menu">
            <a href="{% url 'app_finance:dashboard' %}">Dashboard</a>
            <a href="{% url 'app_finance:summary_month' %}">‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</a>
            <a href="{% url 'app_finance:cash_calendar' %}">‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</a>
            <a href="{% url 'app_finance:debts_overview' %}">‡πÅ‡∏ú‡∏ô‡∏õ‡∏•‡∏î‡∏´‡∏ô‡∏µ‡πâ</a>
            <a href="{% url 'app_finance:monthly_report' %}">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (PDF)</a>
          </div>
        </div>

        <!-- ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ -->
        <div class="nav-dropdown">
          <button class="nav-dropdown-toggle">
            ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
            <span class="nav-caret">‚ñæ</span>
          </button>
          <div class="nav-dropdown-menu">
            <a href="{% url 'app_finance:transactions_list' %}">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</a>
            <a href="{% url 'app_finance:recurring_list' %}">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥</a>
          </div>
        </div>

        <!-- ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ / ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á -->
        <div class="nav-dropdown">
          <button class="nav-dropdown-toggle">
            ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            <span class="nav-caret">‚ñæ</span>
          </button>
          <div class="nav-dropdown-menu">
            <a href="{% url 'app_finance:accounts_manage' %}">‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</a>
            <a href="{% url 'app_finance:categories_manage' %}">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</a>
            <a href="{% url 'app_finance:goals_list' %}">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</a>
            <a href="{% url 'app_finance:budgets_overview' %}">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</a>
            <a href="{% url 'app_finance:tools_home' %}">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</a>
            <a href="{% url 'app_finance:howto' %}">‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</a>
          </div>
        </div>

        <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏•‡∏±‡∏ö Theme (‡πÄ‡∏î‡∏™‡∏Å‡πå‡∏ó‡πá‡∏≠‡∏õ) -->
        <button id="themeToggle" type="button" class="btn btn-ghost btn-sm me-3" title="‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏µ‡∏°">
          üåô
        </button>

        <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö (‡πÅ‡∏î‡∏á) -->
        <a href="{% url 'logout' %}" class="btn btn-logout btn-sm">
          ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
        </a>
      </div>

      <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (Hamburger) -->
      <div class="d-flex d-md-none ms-auto">
        <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏•‡∏±‡∏ö‡∏ò‡∏µ‡∏°‡∏ö‡∏ô mobile -->
        <button type="button"
                class="btn btn-ghost btn-sm js-theme-toggle"
                title="‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏µ‡∏°">
          üåô
        </button>
        <button class="btn btn-ghost btn-sm" type="button"
                data-bs-toggle="offcanvas" data-bs-target="#mobileNav"
                aria-controls="mobileNav" aria-label="‡πÄ‡∏°‡∏ô‡∏π">
          ‚ò∞
        </button>
      </div>
    </div>
  </nav>
  {% endblock navbar %}

  <main class="app-main">
    <div class="app-container">
      {% block content %}{% endblock %}
    </div>
  </main>

  <!-- Offcanvas ‡πÄ‡∏°‡∏ô‡∏π‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ -->
  <div class="offcanvas offcanvas-end offcanvas-custom" tabindex="-1" id="mobileNav" aria-labelledby="mobileNavLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="mobileNavLabel">‡πÄ‡∏°‡∏ô‡∏π OAT Finance</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <div class="mobile-nav-section-title">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</div>
      <a href="{% url 'app_finance:home' %}" class="mobile-nav-link">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
      <a href="{% url 'app_finance:dashboard' %}" class="mobile-nav-link">Dashboard</a>
      <a href="{% url 'app_finance:summary_month' %}" class="mobile-nav-link">‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</a>
      <a href="{% url 'app_finance:cash_calendar' %}" class="mobile-nav-link">‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</a>
      <a href="{% url 'app_finance:monthly_report' %}" class="mobile-nav-link">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (PDF)</a>

      <div class="mobile-nav-section-title">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
      <a href="{% url 'app_finance:transactions_list' %}" class="mobile-nav-link">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</a>
      <a href="{% url 'app_finance:recurring_list' %}" class="mobile-nav-link">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥</a>

      <div class="mobile-nav-section-title">‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á & ‡πÅ‡∏ú‡∏ô</div>
      <a href="{% url 'app_finance:accounts_manage' %}" class="mobile-nav-link">‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</a>
      <a href="{% url 'app_finance:categories_manage' %}" class="mobile-nav-link">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</a>
      <a href="{% url 'app_finance:goals_list' %}" class="mobile-nav-link">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</a>
      <a href="{% url 'app_finance:budgets_overview' %}" class="mobile-nav-link">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</a>
      <a href="{% url 'app_finance:debts_overview' %}" class="mobile-nav-link">‡πÅ‡∏ú‡∏ô‡∏õ‡∏•‡∏î‡∏´‡∏ô‡∏µ‡πâ</a>
      <a href="{% url 'app_finance:tools_home' %}" class="mobile-nav-link">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</a>

      <div class="mobile-nav-section-title">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</div>
      <a href="{% url 'app_finance:howto' %}" class="mobile-nav-link">‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</a>

      <!-- <button type="button" class="mobile-nav-link js-theme-toggle mt-2">
        ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏µ‡∏° (‡∏™‡∏ß‡πà‡∏≤‡∏á / ‡∏°‡∏∑‡∏î)
      </button> -->

      <a href="{% url 'logout' %}" class="mobile-nav-link mt-2" style="color:#fecaca;border-color:#fecaca;">
        ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
      </a>
    </div>
  </div>

  {% if user.is_authenticated %}
  <!-- Quickbar ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≠‡∏ô‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô) -->
  <div class="mobile-quickbar d-md-none">
    <div class="mobile-quickbar-inner py-2">
      <div class="app-container">
        <div class="d-flex gap-2">
          <a href="{% url 'app_finance:transaction_create' %}?type=IN" class="btn btn-brand btn-sm mobile-quickbar-btn">
            + ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö
          </a>
          <a href="{% url 'app_finance:transaction_create' %}?type=OUT" class="btn btn-ghost btn-sm mobile-quickbar-btn">
            + ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢
          </a>
          <a href="{% url 'app_finance:transactions_list' %}" class="btn btn-ghost btn-sm mobile-quickbar-btn">
            ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
          </a>
        </div>
      </div>
    </div>
  </div>
  {% endif %}

  <footer class="py-3 text-center">
    ‡∏à‡∏±‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡πÇ‡∏≠‡πá‡∏ï‡∏™‡∏ö‡∏≤‡∏¢‡πÉ‡∏à‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏µ‡∏•‡∏∞‡∏ß‡∏±‡∏ô üíö
  </footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
  (function(){
    const root = document.documentElement;
    const toggleButtons = document.querySelectorAll(".js-theme-toggle");

    function applyTheme(theme){
      const t = (theme === "light" || theme === "dark") ? theme : "dark";
      root.setAttribute("data-theme", t);

      toggleButtons.forEach(btn => {
        if (!btn) return;
        if (t === "dark"){
          btn.innerHTML = "‚òÄÔ∏è";
          btn.title = "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏ß‡πà‡∏≤‡∏á";
        } else {
          btn.innerHTML = "üåô";
          btn.title = "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î";
        }
      });
    }

    // ‡πÇ‡∏´‡∏•‡∏î‡∏ò‡∏µ‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ß‡πâ
    const stored = localStorage.getItem("finance-theme");
    if (stored){
      applyTheme(stored);
    } else {
      applyTheme(root.getAttribute("data-theme") || "dark");
    }

    toggleButtons.forEach(btn => {
      btn.addEventListener("click", function(){
        const current = root.getAttribute("data-theme") === "light" ? "light" : "dark";
        const next = current === "light" ? "dark" : "light";
        applyTheme(next);
        localStorage.setItem("finance-theme", next);
      });
    });
  })();
</script>

{% block extra_js %}{% endblock %}
</body>
</html>
